<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>task04</title>
</head>
<body>
	<div id="main">
	    <div id="input_box">
		    <input type="text" id="input_txt"  placeholder="Number please!">
		    <button id="left-in">left-in</button>
		    <button id="right-in">right-in</button>
		    <button id="left-out">left-out</button>
		    <button id="right-out">right-out</button>
            <button id="bubble">sort</button>
	    </div>
	    <div id="show_txt">
		    <ul id="show_li">
<!-- 		    <li id="1">1</li>
		        <li id="2">2</li>
		        <li id="3">3</li>
		        <li id="4">4</li> -->
		    </ul>
	    </div>
	    <style type="text/css">
	    	body{
	    		margin:10px;
	    		padding:10px;
	    	}
	    	#show_txt{
	    		display: -webkit-flex; /* Safari */
	    		display: flex;
	    		flex-flow:row nowrap;
	    		justify-content: flex-start;
	    		align-items: flex-start;
	    	}
	    	#show_li li{
	    		width: 30px;
	    		line-height: 30px;
	    		text-align: center;
	    		margin:5px 5px;
	    		color: #fff;
	    		background-color: #f00;
	    		display: inline-block;
	    		flex: none;
	    	}
	    </style>
	    <script>
	    	window.onload=function(){

               //get ele by id,注意jq的$
                function $id(id){
                    return document.getElementById(id);
                }
                //获取各dom节点
                var input_txt=$id('input_txt'),
                    oul=$id('show_li'),
                    left_in=$id('left-in'),
                    right_in=$id('right-in'),
                    left_out=$id('left-out'),
                    right_out=$id('right-out'),
                    left_in=$id('left-in'),
                    s_bubble=$id('bubble'),
                    li_arr=[];

        //第一步：获取input_txt.value：a-检查输入合法性；b-自动输入用于测试;

                //check input value is number?true:false
                function check_input(){
                    var num=parseInt(input_txt.value.trim());
                    if(input_txt.value===''){
                        alert('it is empty!');
                        return false;
                    }else if(!isNaN(num)){
                        if(num>10 && num<100){
                            return true;
                        }
                        else{
                            alert('请输入10-100的整数');
                            return false;}
                    }
                    else{
                        alert('input a number please!');
                        return false;
                    }   
                }

                //set random || user input
                function setrandom(){
                   return input_txt.value=Math.round(11+Math.random()*89);
                }

        //第二步：将input_txt.value push 到数组li_arr里：检查数组长度;
                //check li_arr.length{0,60}
                function check_length(){
                    if(li_arr.length>30){
                        alert('长度超出范围，请添加或删除！');
                        left_out.disabled='disabled';
                        right_out.disabled='disabled';
                        return false;}
                }

        //第三步：操作btn，改变li_arr的值和长度:1.通过id获取btn；2.增减改删btn的操作；3.4种排序的实现            
                //排序
                function sortarr(){
                    var lis=li_arr.length,i,j,temp,newarr;
                    newarr=li_arr.slice(0);
                    for(i=0;i<lis;i++){
                        for(j=lis-1;j>i;j--){
                            var temp=newarr[j-1];
                            if(newarr[j]<newarr[j-1]){
                                newarr[j-1]=newarr[j];
                                newarr[j]=temp;
                            }
                        }
                    }
                    return newarr;
                }

                function change_li_arr(e){
                    //对象是数组
                    var e=e || window.e,
                        target=e.target || e.srcElement;
                        if(check_input()){
                        var num=parseInt(input_txt.value.trim());
                        switch (target.id) {
                            case 'left-in':
                                li_arr.unshift(num)
                                setrandom()
                                break;
                            case 'right-in':
                                li_arr.push(num)
                                setrandom()
                                break;
                            case 'left-out':
                                alert('你删除的元素是：'+li_arr[0] )
                                li_arr.shift(num)
                                break;
                            case 'right-out':
                                alert('你删除的元素是：'+ li_arr[li_arr.length-1])
                                li_arr.pop(num)
                                break;
                            case 'bubble':
                                li_arr=li_arr.sort(sortarr())
                                break;
                        }
                    }else if(target.nodeName.toLowerCase()=== 'li'){
                        var index=target.id;
                        alert('你删除的元素是：'+  li_arr.splice(index,1));
                    }
                    check_length();
                    render(li_arr);
                }

        //第四步：渲染数组里的数值到dom里去，将li的高度设为数组里对应的值
                //create li
                function create_li(myli){
                    var oli=document.createElement('li');
                    var txt=document.createTextNode(myli);
                    oli.appendChild(txt);
                    oli.style.height=myli+'px';
                    return oli;
                };
                //render li_arr in ul
                function render(li_arr){
                    var i,j;
                    for(i=0;i<li_arr.length;i++){
                        j=create_li(li_arr[i]);
                        j.setAttribute('id',i);
                        oul.appendChild(j);
                    }  
                }
        //监听点击事件
                $id('input_box').addEventListener('click',change_li_arr);
                $id('show_txt').addEventListener('click',change_li_arr);
            }
	    </script>
	</div>
</body>
</html>