<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>基础js练习一</title>
</head>
<body>
	<div id="input-num">
		<input type="text" id="input-txt">
		<p id="btn">
		<button class="btn" id="left-in">左侧入</button>
		<button class="btn" id="right-in">右侧入</button>
		<button class="btn" id="left-out">左侧出</button>
		<button class="btn" id="right-out">右侧出</button>
		</p>
	</div>
	<div id="show-num">
	    <ul id="show-list">
	    	 <!-- 在这里添加ul:li,将li 的id 与数组index对应方便存储
	    	 <li id="1"></li>
	    	 <li id="2"></li>-->
	    </ul>
	</div>
	<style>
	    *{
	    	margin: 0;
	    	padding: 0;
	    }
	    #input-num,#show-num{
	    	float: left;
	    	border: 1px solid #d00;
	    	margin: 20px;
	    	padding: 10px;
	    }
	    #show-num{
	    	width:60%;
	    	height:auto;
            display: block;
	    }
		#input-txt{
			height:30px;
			width:95%;
			margin:10px auto;
			padding-left: 2px;
			border-radius: 5px;
			border:1px solid #00d;
		}
        div p{
			width:100%;
			height:30px;
			margin:5px auto;
        }
        p .btn{
        	border:1px solid #00d;
        	background-color: #fff;
        	border-radius: 3px;
        }
        #show-num ul li{
        	height: 20px;
        	width: 20px;
            margin: 5px;
            display:inline-block;
            float: left;
            text-align: center;
            background-color: #0f0;
        }
	</style>
	<script type="text/javascript">

	    //先获取dom节点  
		var input_txt=document.getElementById('input-txt').value;
        var uls=document.getElementById('show-list');
        var patt=/^\d+{1,3}$/;
        var btns=document.getElementsByTagName('button');
        var left_in = document.getElementById('left-in'),
            right_in = document.getElementById('right-in'),
            left_out = document.getElementById('left-out'),
            right_out = document.getElementById('right-out');
        //添加监听事件的处理函数,处理浏览器兼容性
        function addHandler(ele,event,func){
            if(ele.addEventListener){
              ele.addEventListener(event,func);
            }
            else if(ele.attachEvent){
              ele.attachEvent('on'+event,func);
            }
        }
        //设置初始值
        function default_value(){
          var dv=Math.round(Math.random()*100);
          input_txt=dv;
        }
        //判断输入框是否有效
        function input_is_null(){
            if(!patt.test(input_txt.trim()) || input_txt==''){
               alert('请输入数字！');
               input_txt='';
               return false;
            }
            return true;
        }
        //检查队列是否为空
        function check_empty(){
            if(li_arr.length==0){
                left_out.disabled=true;
                right_out.disabled=true;
            }else{
                left_out.disabled=false;
                right_out.disabled=false;
            }
        }

        //监测数组的状态
        var li_arr=[];
        function check_arr(){
            if(input_is_null()){
                if(this.id='left-in'){return li_arr.unshift(input_txt);}
                else if(this.id='right-in'){return li_arr.push(input_txt);}
                else if(this.id='left-out'){
                    check_empty();
                    return li_arr.shift(input_txt);
                    }
                else if(this.id='right-out'){
                    check_empty();
                    return li_arr.pop(input_txt);
                    }
            render();
        }
        //渲染函数来渲染数组里的值,渲染后每个数组元素都有自己的id以便触发this.click事件
        function render(){
            var str='',i;
            for(i=0;i<li_arr.length;i++){
                var oli=document.createElement('li');
                oli.innerHTML=li_arr[i];
                oli.setAttribute('id',i);
                uls.appendChild(oli);
            }
        }
        //点击任意数字则删除该数字；可利用event.target先返回触发该事件的节点
        addHandler(uls,'click',function(e){
            var target=e.target
            if(target.nodeName=='li'){
                var index = e.target.getAttribute('id');
                li_arr.splice(index, 1);
            }
            render();
        })
        //监听btns的点击事件
        function init(){
            for(var i=0;i<btns.length;i++){
            addHandler(btns[i],'click',check_arr);
            }
        }
        init();

	</script>
</body>
</html>